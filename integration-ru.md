# Интеграция Контур и Brusnika.

Интеграция Brusnika и Контур осуществляется через `Kafka` или `Rest API`.

## Данные для интеграции

1. Входящие данные из Brusnika в Контур:

-   Города (Cities)
    -   [МЕТОД] Получить список
-   Проекты (Projects)
    -   [МЕТОД] Получить список
-   Здания (Buildings)
    -   [МЕТОД] Получить список
-   Разделы (Sections)
    -   [МЕТОД] Получить список
-   Помещения (Premises)
    -   [МЕТОД] Получить список
-   Сделки и статусы (Leads and statuses)
    -   [МЕТОД] Получить список
-   Свободные Слоты для календаря (Time Slots)
    -   [МЕТОД] Получить список

2. Данные и методы, передаваемые из Контур в Brusnika:

-   Пользователи (Users)
-   Агентства (Agencies)
    -   [МЕТОД] Создать агентство
    -   [МЕТОД] Найти агентство
-   Клиенты (Clients)
    -   [МЕТОД] Создать клиента
    -   [МЕТОД] Найти клиента
-   Бронирование (Bookings)
    -   [МЕТОД] Создать бронь
    -   [МЕТОД] Отменить бронь
-   Показы (Visits)
    -   [МЕТОД] Создать визит
    -   [МЕТОД] Отменить визит
-   Свободные Слоты для календаря (Time Slots)
    -   [МЕТОД] Забронировать временные слоты

## Формат данных Контур

### Города (Cities)

---

-   Название поля: `id`
-   Тип: `number`

---

-   Название поля: `name`
-   Тип: `string`

---

-   Название поля: `long`
-   Тип: `string`

---

-   Название поля: `lat`
-   Тип: `string`

---

### Проекты (Projects)

---

-   Название в BT: `id проекта`
-   Название поля: `id`
-   Тип: `number`

---

-   Название в BT: `Название проекта`
-   Название поля: `name`
-   Тип: `string`

---

-   Название в BT: `Матрица помещений на этажах`
-   Название поля: `?`
-   Тип: `?`

---

-   Название в BT: `Короткое описание проекта`
-   Название поля: `brief_description`
-   Тип: `string`

---

-   Название в BT: `Подробное описание проекта`
-   Название поля: `detailed_description`
-   Тип: `string`

---

-   Название в BT: `Срок сдачи`
-   Название поля: `end_date`
-   Тип: `Date`

---

-   Название в BT: `Фотографии проекта`
-   Название поля: `photo`
-   Тип: `string`

---

-   Название в BT: `Ссылка на сайт`
-   Название поля: `link`
-   Тип: `string`

---

-   Название в BT: `Описание проекта`
-   Название поля: `description`
-   Тип: `string`

---

### Здания (Buildings)

---

-   Название в BT: `id объекта`
-   Название поля: `id`
-   Тип: `number`

---

-   Название в BT: `Адрес объекта`
-   Название поля: `address`
-   Тип: `string`

---

-   Название в BT: `Количество этажей`
-   Название поля: `number_of_floors`
-   Тип: `number`

---

-   Название в BT: `Короткое описание проекта`
-   Название поля: `brief_description`
-   Тип: `string`

---

-   Название в BT: `Подробное описание проекта`
-   Название поля: `detailed_description`
-   Тип: `string`

---

-   Название в BT:
    `Количество свободных помещений 1го типа (количество квартир)`
-   Название поля: `total_apartment`
-   Тип: `string`

---

-   Название в BT:
    `Количество свободных помещений 2го типа (количество машино-мест)`
-   Название поля: `total_parking_space`
-   Тип: `string`

---

-   Название в BT:
    `Количество свободных помещений 3го типа (количество кладовых)`
-   Название поля: `total_storage`
-   Тип: `string`

---

-   Название в BT:
    `Количество свободных помещений 4го типа (количество коммерческих помещений)`
-   Название поля: `total_commercial`
-   Тип: `string`

---

### Помещения (Premises)

---

-   Название в BT: `id проекта`
-   Название поля: `---`
-   Тип: `---`

---

-   Название в BT: `id объекта`
-   Название поля: `building_id`
-   Тип: `number`

---

-   Название в BT: `id помещения`
-   Название поля: `id`
-   Тип: `number`

---

-   Название в BT: `вид помещения`
-   Название поля: `type`
-   Тип: `enum`
-   Ценности:
    -   `apartment`
    -   `storeroom`
    -   `parking`
    -   `commercial`

---

-   Название в BT: `комнатность`
-   Название поля: `rooms`
-   Тип: `number`

---

-   Название в BT: `площадь`
-   Название поля: `size`
-   Тип: `number`

---

-   Название в BT: `стоимость`
-   Название поля: `price`
-   Тип: `bigint`

---

-   Название в BT: `этаж`
-   Название поля: `floor`
-   Тип: `number`

---

-   Название в BT:
    1.  `признак “обмен рф”`
    2.  `признак “окна в пол”`
    3.  `признак “окно в коридоре”`
    4.  `признак “окно в санузле”`
    5.  `признак “без отделки”`
    6.  `признак “двухуровневая”`
    7.  `признак “отдельный вход`
    8.  `признак “свободная планировка”`
    9.  `признак “балкон”`
    10. `признак “летняя кухня на крыше”`
    11. `признак “лоджия”`
    12. `признак “терраса”`
    13. `признак “терраса на кровле”`
    14. `признак “терраса с выходом на крышу”`
    15. `признак “второй санузел”`
    16. `признак “гардероб в спальне”`
    17. `признак “гардеробная”`
    18. `признак “кладовая”`
    19. `признак “постирочная”`
    20. `признак “мастер-спальня”`
    21. `признак “вторичная квартира”`
    22. `признак “наземный паркинг/подземный паркинг”`
-   Название поля: `feature`
-   Тип: `enum[]`
-   Ценности:
    1.  `sign_exchange_rf`
    2.  `sign_floor_to_ceiling`
    3.  `sign_window_in_the_corridor`
    4.  `sign_window_in_the_bathroom`
    5.  `sign_no_finishing`
    6.  `sign_two_level`
    7.  `sign_separate_entrance`
    8.  `sign_open_plan`
    9.  `sign_balcony`
    10. `sign_summer_kitchen_on_the_roof`
    11. `sign_loggia`
    12. `sign_terrace`
    13. `sign_roof_terrace`
    14. `sign_terrace_with_access_to_the_roof`
    15. `sign_second_bathroom`
    16. `sign_dressing_room_in_the_bedroom`
    17. `sign_dressing_room`
    18. `sign_storage_room`
    19. `sign_laundry_room`
    20. `sign_master_bedroom`
    21. `sign_secondary_apartment`
    22. `sign_ground_parking`

---

-   Название в BT: `фотографии помещения`
-   Название поля: `photos`
-   Тип: `string[]`

---

-   Название в BT: `свободно для бронирования`
-   Название поля: `is_booked`
-   Тип: `boolean`

---

-   Название в BT: `вариант покупки`
-   Название поля: `purchase_option`
-   Тип: ``
-   Ценности:
    -   `mortage`
    -   `installment`
    -   `bill`
    -   `full_payment`

---

-   Название в BT: `Куплено`
-   Название поля: `is_sold`
-   Тип: `boolean`

---

### Сделки и статусы (Leads and statuses)

---

-   Название в BT: `id сделки`
-   Название поля: `id`
-   Тип: `number`

---

-   Название в BT: `id клиента`
-   Название поля: `client_id`
-   Тип: `number`

---

-   Название в BT: `id помещения`
-   Название поля: `premise_id`
-   Тип: `number`

---

-   Название в BT: `статус сделки`
-   Название поля: `state`
-   Тип: `enum`
-   Ценности:
    -   `Активные`
    -   `На паузе`
    -   `Проиграна`
    -   `Выиграна`

---

-   Название в BT: `этап сделки`
-   Название поля: `current_status`
-   Тип: `enum`
-   Ценности:
    -   `открыта`
    -   `интерес к покупке`
    -   `презентация`
    -   `бронь`
    -   `заявка на договор`
    -   `договор зарегистрирован`
    -   `выиграна`
    -   `отмененная бронь`
    -   `слетевшая бронь`
    -   `на паузе`
    -   `проверка лида`
    -   `проиграна`

---

-   Название в BT: `признак “пройден NPS”`
-   Название поля: `sign_nps_passed`
-   Тип: `boolean`

---

-   Название в BT: `вознаграждение по сделке`
-   Название поля: `fee`
-   Тип: `number`

---

-   Название в BT: `дата старта сделки`
-   Название поля: `start_date`
-   Тип: `date`

---

-   Название в BT: `Дата последнего изменения этапа `
-   Название поля: `status_updated_at`
-   Тип: `date`

---

-   Название в BT: `id агента`
-   Название поля: `agent_id`
-   Тип: `number`

---

-   Название в BT: `id менеджера`
-   Название поля: `manager_id`
-   Тип: `number`

---

### Свободные Слоты для календаря (Time Slots)

---

### Пользователи (Users)

---

-   Название в BT: `id пользователя`
-   Название поля: `id`
-   Тип: `number`

---

-   Название в BT: `Фамилия пользователя`
-   Название поля: `lastName`
-   Тип: `string`

---

-   Название в BT: `Название пользователя`
-   Название поля: `firstName`
-   Тип: `string`

---

-   Название в BT: `Отчество пользователя`
-   Название поля: `---`
-   Тип: `---`

---

-   Название в BT: `Телефон пользователя`
-   Название поля: `phone`
-   Тип: `string`

---

-   Название в BT: `email пользователя`
-   Название поля: `email`
-   Тип: `string`

---

-   Название в BT: `Статус пользователя`
-   Название поля: `status`
-   Тип: `enum`
-   Ценности:
    -   `active`
    -   `blocked`

---

-   Название в BT: `Роль пользователя`
-   Название поля: `role`
-   Тип: `enum`
-   Ценности:
    -   `ADMIN`
    -   `AGENT`
    -   `MANAGER`
    -   `NEW_MEMBER`
    -   `HEAD_OF_AGENCY`
    -   `OZK_MANAGER`
    -   `AFFILIATE_MANAGER`

---

-   Название в BT: `Признак заявки на изменение роли`
-   Название поля: `temporary_role`
-   Тип: `enum`
-   Ценности:
    -   `ADMIN`
    -   `AGENT`
    -   `MANAGER`
    -   `NEW_MEMBER`
    -   `HEAD_OF_AGENCY`
    -   `OZK_MANAGER`
    -   `AFFILIATE_MANAGER`

---

-   Название в BT: `Город пользователя`
-   Название поля: `city_id`
-   Тип: `number`

---

-   Название в BT: `Дата рождения пользователя`
-   Название поля: `birthDate`
-   Тип: `date`

---

-   Название в BT: `id Агентство недвижимости пользователя`
-   Название поля: `agency_id`
-   Тип: `number`

---

-   Название в BT: `Дата начала работы в АН пользователя`
-   Название поля: `workStartDate`
-   Тип: `date`

---

-   Название в BT: `Фото пользователя`
-   Название поля: `avatar`
-   Тип: `string`

---

-   Название в BT: `Количество оставшихся бронирований`
-   Название поля: `remaining_user_creation_limit`
-   Тип: `number`

---

### Агентства (Agencies)

---

-   Название в BT: `id Агентство недвижимости`
-   Название поля: `id`
-   Тип: `number`

---

-   Название в BT: `Название агентства недвижимости`
-   Название поля: `title`
-   Тип: `string`

---

-   Название в BT: `Основной город работы агентства`
-   Название поля: `city_id`
-   Тип: `number`

---

-   Название в BT: `Юридическое название компании`
-   Название поля: `legalName`
-   Тип: `string`

---

-   Название в BT: `ИНН АН`
-   Название поля: `inn`
-   Тип: `string`

---

-   Название в BT: `Телефон АН`
-   Название поля: `phone`
-   Тип: `string`

---

-   Название в BT: `email АН`
-   Название поля: `email`
-   Тип: `string`

---

-   Название в BT: `ФИО контактного лица от агентства недвижимости`
-   Название поля: `ownerFullName`
-   Тип: `string`

---

-   Название в BT: `Телефон контактного лица от агентства недвижимости`
-   Название поля: `ownerPhone`
-   Тип: `string`

---

### Клиенты (Clients)

---

-   Название в BT: `id клиента`
-   Название поля: `id`
-   Тип: `number`

---

-   Название в BT: `Фамилия клиента`
-   Название поля: `fullname`
-   Тип: `string`

---

-   Название в BT: `Название клиента`
-   Название поля: `fullname`
-   Тип: `string`

---

-   Название в BT: `Отчество клиента`
-   Название поля: `fullname`
-   Тип: `string`

---

-   Название в BT: `Телефон клиента`
-   Название поля: `phone_number`
-   Тип: `string`

---

-   Название в BT: `Комментарий по сделке клиента`
-   Название поля: `comment`
-   Тип: `string`

---

-   Название в BT: `Дата заведения клиента`
-   Название поля: `actived_date`
-   Тип: `date (timestamp)`

---

-   Название в BT: `Последняя дата закрепления клиента`
-   Название поля: `fixing_type_updated_at`
-   Тип: `date (timestamp)`

---

-   Название в BT: `Дата окончания последнего закрепления клиента`
-   Название поля: `expiration_date`
-   Тип: `date (timestamp)`

---

-   Название в BT: `Статус закрепления`
-   Название поля: `fixing_type`
-   Тип: `enum`
-   Ценности:
    -   `проверка лида`
    -   `отказ в закреплении`
    -   `слабое закрепление`
    -   `сильное закрепление`

---

-   Название в BT: `id агента закрепленного за клиентом`
-   Название поля: `agent_id`
-   Тип: `number`

---

-   Название в BT: `Тип закрепления клиента`
-   Название поля: `fixing_type`
-   Тип: `enum`
-   Ценности:
    -   `проверка лида`
    -   `отказ в закреплении`
    -   `слабое закрепление`
    -   `сильное закрепление`

---

-   Название в BT: `id сделок по клиенту`
-   Название поля: `---`
-   Тип: `---`

---

-   Название в BT: `наличие задач менеджера по клиенту`
-   Название поля: `---`
-   Тип: `---`

---

### Бронирование (Bookings)

---

-   Название в BT: `id бронирования`
-   Название поля: `id`
-   Тип: `number`

---

-   Название в BT: `id помещения`
-   Название поля: `premise_id`
-   Тип: `number`

---

-   Название в BT: `id клиента`
-   Название поля: `client_id`
-   Тип: `number`

---

-   Название в BT: `id агента`
-   Название поля: `agent_id`
-   Тип: `number`

---

-   Название в BT: `дата бронирования`
-   Название поля: `date`
-   Тип: `date ("YYYY-MM-DD")`

---

-   Название в BT: `время бронирования`
-   Название поля: `time`
-   Тип: `"HH:mm"`

---

-   Название в BT: `вариант покупки`
-   Название поля: `purchase_option`
-   Тип: `enum`
-   Ценности:
    -   `mortage`
    -   `installment`
    -   `bill`
    -   `full_payment`

---

-   Название в BT: `статус бронирования`
-   Название поля: `status`
-   Тип: `enum`
-   Ценности:
    -   `open`
    -   `success`
    -   `fail`

---

### Показы (Visits)

---

-   Название в BT: `id показа`
-   Название поля: `id`
-   Тип: `number`

---

-   Название в BT: `id проекта`
-   Название поля: `project_id`
-   Тип: `number`

---

-   Название в BT: `id агента`
-   Название поля: `agent_id`
-   Тип: `number`

---

-   Название в BT: `id клиента`
-   Название поля: `client_id`
-   Тип: `number`

---

-   Название в BT: `дата показа`
-   Название поля: `date`
-   Тип: `date ("YYYY-MM-DD")`

---

-   Название в BT: `время показа`
-   Название поля: `time`
-   Тип: `"HH:mm"`

---

-   Название в BT: `дата формирования заявки на показ`
-   Название поля: `request_date`
-   Тип: `date (timestamp)`

---

-   Название в BT: `время формирования заявки на показ`
-   Название поля: `request_time`
-   Тип: `date (timestamp)`

---

-   Название в BT: `статус заявки на показ`
-   Название поля: `status`
-   Тип: `enum`
-   Ценности:
    -   `open`
    -   `success`
    -   `fail`

---
